<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>♟️ Chess Dashboard</title>
<link rel="stylesheet" href="https://unpkg.com/chessboardjs@1.0.0-beta.6/dist/chessboard-1.0.0.min.css"/>
<style>
body { font-family: Arial; text-align: center; background:#f5f5f5; }
#board { width: 320px; margin: 20px auto; }
#status { font-weight:bold; margin-top:10px; }
#timer { margin-top:10px; font-size:16px; }
</style>
</head>
<body>

<h2>♟️ Chess Dashboard</h2>
<div id="status">Loading game...</div>
<div id="timer"></div>
<div id="board"></div>

<!-- Chess Libraries -->
<script src="https://unpkg.com/chess.js@1.0.0-beta.9/chess.js"></script>
<script src="https://unpkg.com/chessboardjs@1.0.0-beta.6/dist/chessboard-1.0.0.min.js"></script>

<script>
let game, board;
let whiteTime = 600, blackTime = 600; // 10 min
let timerInterval;

// Auto start system game
function initBoard(){
  game = new Chess();
  board = Chessboard("board", {
    draggable: true,
    position: "start",
    orientation: "white",
    onDrop: onDrop
  });
  document.getElementById('status').innerText = "System Game | You vs Computer | Playing...";
  updateStatus();
  startTimer();
}

function onDrop(source, target){
  const move = game.move({from: source, to: target, promotion: 'q'});
  if(!move) return "snapback";
  board.position(game.fen());
  updateStatus();
  setTimeout(systemMove, 500);
}

function systemMove(){
  if(game.game_over()) return;
  const moves = game.moves();
  const move = moves[Math.floor(Math.random()*moves.length)];
  game.move(move);
  board.position(game.fen());
  updateStatus();
}

function updateStatus(){
  let moveColor = game.turn() === 'w' ? 'White' : 'Black';
  let status = '';
  if(game.in_checkmate()){
    status = 'Checkmate! ' + (moveColor==='White'?'Black':'White') + ' wins.';
    stopTimer();
  } else if(game.in_draw() || game.in_stalemate() || game.in_threefold_repetition()){
    status = 'Draw!';
    stopTimer();
  } else{
    status = 'Playing... ' + moveColor + ' to move';
  }
  document.getElementById('status').innerText = status;
}

function startTimer(){
  timerInterval = setInterval(()=>{
    if(game.turn()==='w') whiteTime--; else blackTime--;
    document.getElementById('timer').innerText = `White: ${formatTime(whiteTime)} | Black: ${formatTime(blackTime)}`;
    if(whiteTime<=0 || blackTime<=0){
      clearInterval(timerInterval);
      document.getElementById('status').innerText = (whiteTime<=0?'White':'Black') + ' time over. Game Over';
    }
  },1000);
}

function stopTimer(){ clearInterval(timerInterval); }

function formatTime(sec){
  let m = Math.floor(sec/60);
  let s = sec%60;
  return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
}

// Auto start when page loads
window.onload = initBoard;
</script>
</body>
</html>
